# pivot_커뮤니티 WUB 시트 간단한 수식 적용 방법

## 🎯 가장 간단한 방법 (권장)

Apps Script나 복잡한 ARRAYFORMULA 없이, **각 열의 시작 행에 수식을 입력하고 복사**하는 방법입니다.

---

## 📋 각 열별 수식

### H열: WoW(pv) - 전주 대비 변화율
**위치**: H3 셀
```excel
=IF(C3="", "", IF(C2=0, "", C3/C2-1))
```

### O열: 커뮤니티 WUB - 합계
**위치**: O10 셀
```excel
=B10+K10
```

### P열: 커뮤니티 WPV - 합계
**위치**: P2 셀
```excel
=C2+L2
```

### Q열: WoW(wub) - 전주 대비 변화율
**위치**: Q3 셀
```excel
=IF(O3="", "", IF(O2=0, "", O3/O2-1))
```

### S열: WoW(wpv) - 전주 대비 변화율
**위치**: S14 셀
```excel
=IF(P14="", "", IF(P13=0, "", P14/P13-1))
```

### U열: 전체 WUB 대비(커뮤니티) - 비율
**위치**: U2 셀
```excel
=IF(AA2="", "", IF(X2=0, "", AA2/X2))
```

---

## 🚀 적용 방법 (3단계)

### 1단계: 시작 행에 수식 입력
각 열의 시작 행(위치 참고)에 위의 수식을 입력합니다.

### 2단계: 수식 복사
각 열의 시작 행 셀을 선택한 후:

**방법 A: 드래그**
1. 시작 행 셀 선택 (예: H3)
2. 셀의 오른쪽 하단 모서리(작은 사각형)를 더블클릭
3. 또는 마지막 데이터 행까지 드래그

**방법 B: 복사-붙여넣기**
1. 시작 행 셀 선택 후 복사 (Ctrl+C / Cmd+C)
2. 해당 열의 전체 범위 선택 (예: H3부터 마지막 행까지)
3. 붙여넣기 (Ctrl+V / Cmd+V)
4. Google Sheets가 자동으로 행 번호를 조정합니다

**방법 C: Ctrl+D (Windows) / Cmd+D (Mac)**
1. 시작 행 셀 선택
2. Ctrl+Shift+아래 화살표로 마지막 행까지 선택
3. Ctrl+D (또는 Cmd+D)로 수식 복사

### 3단계: 새 행 추가 시
새 행을 추가한 후:
- 해당 열의 시작 행 수식을 복사하여 새 행에 붙여넣기
- 또는 위의 방법으로 다시 확장

---

## 💡 자동화 팁

### 팁 1: 수식 보호
중요한 수식이 있는 열을 보호하여 실수로 삭제되지 않도록 할 수 있습니다:
1. 열 선택 (예: H열 전체)
2. 데이터 > 시트 및 범위 보호
3. "이 범위 편집 권한이 있는 사용자만" 선택

### 팁 2: 수식 템플릿 행 만들기
1. 한 행에 모든 수식을 입력 (예: 2행)
2. 이 행을 숨기거나 보호
3. 새 행 추가 시 이 템플릿 행을 복사하여 사용

### 팁 3: 조건부 서식으로 수식 확인
수식이 있는 셀에 배경색을 적용하여 시각적으로 확인:
1. 열 선택
2. 서식 > 조건부 서식
3. "수식 사용" 선택
4. `=ISFORMULA(H3)` 입력
5. 배경색 선택

---

## ⚠️ 주의사항

1. **행 추가 시**: 새 행에 수식을 수동으로 복사해야 합니다
2. **수식 덮어쓰기**: 수식이 있는 셀에 값을 입력하면 수식이 삭제됩니다
3. **참조 오류**: 행을 삭제하면 수식이 깨질 수 있으므로 주의하세요

---

## 🔄 Apps Script vs 간단한 수식 비교

| 항목 | 간단한 수식 | Apps Script |
|------|------------|-------------|
| **설정 시간** | 5분 | 15분 |
| **자동화** | 수동 복사 필요 | 완전 자동 |
| **유지보수** | 쉬움 | 코드 수정 필요 |
| **새 행 추가** | 수동 복사 | 자동 적용 |
| **권장 상황** | 데이터 추가가 드문 경우 | 데이터 추가가 빈번한 경우 |

---

## 📞 결론

- **데이터 추가가 가끔**: 간단한 수식 방법 권장
- **데이터 추가가 자주**: Apps Script 권장
- **복잡한 로직 필요**: Apps Script 권장

현재 상황에 맞는 방법을 선택하세요!
